name: Discord Notifications

on:
  pull_request:
    types: [opened, closed, reopened, edited]
  push:
    branches:
      - main

jobs:
  discord_notification:
    runs-on: ubuntu-latest

    steps:
      - name: Send Personal Discord Notification with Embed
        uses: Ilshidur/action-discord-webhook@v1
        with:
          webhook-url: ${{ secrets.DISCORD_WEBHOOK_URL }}
          message: |
            **Pull Request Update**
        env:
          EMBED_DATA: |
            {
              "embeds": [{
                "title": "New Pull Request Action! ðŸŽ‰",
                "description": "A PR has been created or updated. Check it out below!",
                "color": 3066993,
                "fields": [
                  {
                    "name": "Pull Request Title",
                    "value": "${{ github.event.pull_request.title }}",
                    "inline": false
                  },
                  {
                    "name": "Action",
                    "value": "${{ github.event.action }}",
                    "inline": true
                  },
                  {
                    "name": "Author",
                    "value": "@${{ github.event.pull_request.user.login }}",
                    "inline": true
                  },
                  {
                    "name": "PR URL",
                    "value": "[Click here to view it!](${{ github.event.pull_request.html_url }})",
                    "inline": false
                  },
                  {
                    "name": "Description",
                    "value": "${{ github.event.pull_request.body }}",
                    "inline": false
                  }
                ],
                "footer": {
                  "text": "Stay awesome!"
                }
              }]
            }
          run: |
            curl -X POST -H "Content-Type: application/json" \
            -d "${EMBED_DATA}" \
            ${{ secrets.DISCORD_WEBHOOK_URL }}
